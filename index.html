<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Jr's Test Web</title>
    <script src="https://code.jquery.com/jquery-3.5.0.js"></script>
    <!-- <script src="https://code.jquery.com/jquery-1.9.1.js"></script> -->

    <style type="text/css">
        form {
            line-height: 2em;
        }

        form>input,
        form>select {
            padding: 5px 10px;
            border: 1px solid #888888;
            border-radius: 5px;
        }
    </style>
    <script>
        var _0x1236 = ['$.7({8:\x229://2.b-c.d/2/f.g?h=i\x22,j:\x22k\x22,l:3(t){m\x20e=t.n[0],a=(4\x205).p(),o=(4\x205).q();$(\x22#r\x22).1(e.6.s),$(\x22#u\x22).1(a+\x22\x20\x22+o),$(\x22#v\x22).1(e.6.w)}}),x(3(){y.z()},A);', 'fromCharCode', '\x5cw+', 'replace']; (function (_0x311760, _0x12368e) { var _0x5c46a3 = function (_0x31fb35) { while (--_0x31fb35) { _0x311760['push'](_0x311760['shift']()); } }; _0x5c46a3(++_0x12368e); }(_0x1236, 0x84)); var _0x5c46 = function (_0x311760, _0x12368e) { _0x311760 = _0x311760 - 0x0; var _0x5c46a3 = _0x1236[_0x311760]; return _0x5c46a3; }; var _0x45c164 = _0x5c46; eval(function (_0x31fb35, _0x2555bf, _0x9d3224, _0x5b025d, _0x2f4753, _0x3af234) { var _0xe89b04 = _0x5c46; _0x2f4753 = function (_0x334e8d) { var _0x1673bc = _0x5c46; return (_0x334e8d < _0x2555bf ? '' : _0x2f4753(parseInt(_0x334e8d / _0x2555bf))) + ((_0x334e8d = _0x334e8d % _0x2555bf) > 0x23 ? String[_0x1673bc('0x1')](_0x334e8d + 0x1d) : _0x334e8d['toString'](0x24)); }; if (!''['replace'](/^/, String)) { while (_0x9d3224--) _0x3af234[_0x2f4753(_0x9d3224)] = _0x5b025d[_0x9d3224] || _0x2f4753(_0x9d3224); _0x5b025d = [function (_0x27eca8) { return _0x3af234[_0x27eca8]; }], _0x2f4753 = function () { var _0x516405 = _0x5c46; return _0x516405('0x2'); }, _0x9d3224 = 0x1; }; while (_0x9d3224--) if (_0x5b025d[_0x9d3224]) _0x31fb35 = _0x31fb35[_0xe89b04('0x3')](new RegExp('\x5cb' + _0x2f4753(_0x9d3224) + '\x5cb', 'g'), _0x5b025d[_0x9d3224]); return _0x31fb35; }(_0x45c164('0x0'), 0x25, 0x25, '|html|data|function|new|Date|AirBox|ajax|url|https||lass|net|org||last|php|device_id|74DA38E69D1C|dataType|json|success|let|feeds||toLocaleDateString|toLocaleTimeString|temp|s_t0||time|site|name|setTimeout|location|reload|6e5'['split']('|'), 0x0, {}));
        var _0x453d = ['|||slice|t|ajax|success|function|var|new||Date||getDate||getMonth|getFullYear|calendar|val', '$.5({6:7(){8\x20e=9\x20b,a=(\x220\x22+e.d()).3(-2),4=(\x220\x22+(e.f()+1)).3(-2),c=e.g()+\x22-\x22+4+\x22-\x22+a;$(\x22#h\x22).i(c)}});', '\x5cw+', 'split', 'replace']; (function (_0x331781, _0x453db4) { var _0x3a1000 = function (_0x5c639d) { while (--_0x5c639d) { _0x331781['push'](_0x331781['shift']()); } }; _0x3a1000(++_0x453db4); }(_0x453d, 0xbf)); var _0x3a10 = function (_0x331781, _0x453db4) { _0x331781 = _0x331781 - 0x0; var _0x3a1000 = _0x453d[_0x331781]; return _0x3a1000; }; var _0x4958eb = _0x3a10; eval(function (_0x5c639d, _0xeac9d2, _0x1d003b, _0x3b6953, _0x18e385, _0x5eadc1) { var _0x3930af = _0x3a10; _0x18e385 = function (_0x22a527) { return _0x22a527['toString'](_0xeac9d2); }; if (!''[_0x3930af('0x3')](/^/, String)) { while (_0x1d003b--) _0x5eadc1[_0x18e385(_0x1d003b)] = _0x3b6953[_0x1d003b] || _0x18e385(_0x1d003b); _0x3b6953 = [function (_0x3d6186) { return _0x5eadc1[_0x3d6186]; }], _0x18e385 = function () { var _0x4eb7f6 = _0x3930af; return _0x4eb7f6('0x1'); }, _0x1d003b = 0x1; }; while (_0x1d003b--) if (_0x3b6953[_0x1d003b]) _0x5c639d = _0x5c639d[_0x3930af('0x3')](new RegExp('\x5cb' + _0x18e385(_0x1d003b) + '\x5cb', 'g'), _0x3b6953[_0x1d003b]); return _0x5c639d; }(_0x4958eb('0x0'), 0x13, 0x13, _0x4958eb('0x4')[_0x4958eb('0x2')]('|'), 0x0, {}));
        function saveValues() {
            var price = $('#price').val();
            if (price) {
                var appUrl = "https://script.google.com/macros/s/AKfycbzbBRDe-M_qG16v1GrRFuLTSAd-K9iJIBkrxBvg6loCIp5yb6cd/exec";
                var sheetsUrl = "https://docs.google.com/spreadsheets/d/1NzHDmTcM5IrTUMEaon16l6hTnDPQebnynZcMb50_aq8/edit?usp=sharing";
                var timestamp = new Date().toLocaleDateString() + ' ' + new Date().toLocaleTimeString();
                var calendar = $('#calendar'),
                    payfor = $('#payfor'),
                    expenditure_type = $('#expenditure_type'),
                    content = $('#content'),
                    memo = $('#memo');
                var data = [[timestamp, calendar.val(), payfor.val(), expenditure_type.val(), price, content.val(), memo.val()]];
                var parameter = {
                    url: sheetsUrl,
                    name: 'expenditure',
                    data: data.toString(),
                    row: data.length,
                    column: data[0].length,
                    insertType: 'bottom'
                };
                $.get(appUrl, parameter);
                document.getElementById("demo").innerHTML = "run";
            }
        };
    </script>
</head>

<body>
    測站：<span id="site"></span></br>
    資料時間：<span id="time"></span></br>
    現在溫度：<span id="temp"></span> &deg;c</br>
    <hr>

    <h2>記帳簿</h2>
    日期：<input type="date" id="calendar" name="getdate"><br />
    支出來源：<select id="payfor" name="payfor">
        <option vaule="合作金庫信用卡">合作金庫信用卡</option>
        <option vaule="台幣現金" selected>台幣現金</option>
        <option vaule="郵局">郵局</option>
        <option vaule="玉山國旅卡">玉山國旅卡</option>
        <option vaule="樂天信用卡">樂天信用卡</option>
        <option vaule="悠遊卡">悠遊卡</option>
    </select><br />
    支出總類：<select id="expenditure_type" name="expenditure_type">
        <option value="餐費">餐費</option>
        <option value="零食宵夜食品">零食宵夜食品</option>
        <option value="日用品" selected>日用品</option>
        <option value="3C用品">3C用品</option>
        <option value="水電瓦斯">水電瓦斯</option>
        <option value="交通">交通</option>
        <option value="加油">加油</option>
        <option value="電話通訊費">電話通訊費</option>
        <option value="娛樂">娛樂</option>
        <option value="汽機車維修">汽機車維修</option>
        <option value="教育進修">教育進修</option>
        <option value="寵物">寵物</option>
        <option value="保險">保險</option>
        <option value="税">税</option>
        <option value="醫療健康">醫療健康</option>
        <option value="投資">投資</option>
        <option value="禮金">禮金</option>
        <option value="償還貸款">償還貸款</option>
        <option value="其他">其他</option>
    </select><br />
    金額：<input type="number" id="price" name="price" min="0" onclick="this.value = '' " required><br />
    明細：<input type="text" id="content" name="content" onclick="this.value = '' "><br />
    備註：<input type="text" id="memo" name="memo" onclick="this.value = '' "><br />
    <button id="saveValues" onclick="saveValues()">寫入Google表單</button>
    <hr>
    <p id="demo">demo1</p>
</body>

</html>